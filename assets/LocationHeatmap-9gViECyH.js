import{j as e,C as t}from"./index-CNu6f57h.js";import{r as n}from"./react-vendor-zN3dnueO.js";import{M as r,U as s,X as o,I as i}from"./ui-vendor-DmOUGBWX.js";import"./date-vendor-BWBGyv18.js";import"./chart-vendor-dAIseTT7.js";const a=({candidates:a})=>{const l=n.useRef(null),c=n.useRef(null),d=n.useRef(null),m=n.useRef(null),u=n.useRef([]),[x,p]=n.useState(null),[h,g]=n.useState({totalMapped:0,isLoaded:!1});return n.useEffect((()=>{if(!l.current)return;c.current&&c.current.remove(),c.current=window.L.map(l.current,{zoomControl:!1,attributionControl:!1}).setView([20.5937,78.9629],5);const e=window.L.control({position:"topright"});e.onAdd=function(){var e,t;const n=window.L.DomUtil.create("div","leaflet-control-zoom custom-zoom-control");return n.innerHTML='\n        <button id="zoom-in" class="p-2 bg-white rounded-t-md border border-gray-300 hover:bg-gray-100 flex items-center justify-center">\n          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n            <circle cx="12" cy="12" r="10"></circle>\n            <line x1="12" y1="8" x2="12" y2="16"></line>\n            <line x1="8" y1="12" x2="16" y2="12"></line>\n          </svg>\n        </button>\n        <button id="zoom-out" class="p-2 bg-white rounded-b-md border border-b-gray-300 border-l-gray-300 border-r-gray-300 hover:bg-gray-100 flex items-center justify-center">\n          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n            <circle cx="12" cy="12" r="10"></circle>\n            <line x1="8" y1="12" x2="16" y2="12"></line>\n          </svg>\n        </button>\n      ',null==(e=n.querySelector("#zoom-in"))||e.addEventListener("click",(()=>{c.current.zoomIn()})),null==(t=n.querySelector("#zoom-out"))||t.addEventListener("click",(()=>{c.current.zoomOut()})),n},e.addTo(c.current);const t=window.L.control.attribution({position:"bottomright",prefix:""}).addTo(c.current);t.setPrefix(""),t.addAttribution('Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'),window.L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:""}).addTo(c.current);const n=a.filter((e=>!e.error&&e.location_coordinates&&"number"==typeof e.location_coordinates.lat&&"number"==typeof e.location_coordinates.lng&&!isNaN(e.location_coordinates.lat)&&!isNaN(e.location_coordinates.lng))).map((e=>[e.location_coordinates.lat,e.location_coordinates.lng,1])),r=n.length;return g({totalMapped:r,isLoaded:!0}),n.length>0&&(d.current=window.L.heatLayer(n,{radius:25,blur:15,maxZoom:17,gradient:{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},maxOpacity:.7}).addTo(c.current)),m.current=window.L.markerClusterGroup({showCoverageOnHover:!1,maxClusterRadius:40,iconCreateFunction:function(e){const t=e.getChildCount();let n="small",r="bg-blue-500";return t>50?(n="large",r="bg-red-500"):t>10&&(n="medium",r="bg-lime-500"),window.L.divIcon({html:`<div class="cluster-marker ${r} ${n}">${t}</div>`,className:"custom-cluster-icon",iconSize:window.L.point(40,40)})}}),c.current.addLayer(m.current),u.current=a.filter((e=>!e.error&&e.location_coordinates&&"number"==typeof e.location_coordinates.lat&&"number"==typeof e.location_coordinates.lng&&!isNaN(e.location_coordinates.lat)&&!isNaN(e.location_coordinates.lng))).map((e=>{var t;const n=e.location_coordinates.lat,r=e.location_coordinates.lng,s=((e,t,n)=>{const r=n.filter((n=>n.location_coordinates&&Math.abs(n.location_coordinates.lat-e)<.05&&Math.abs(n.location_coordinates.lng-t)<.05)).length;return r>20?"#EF4444":r>5?"#65A30D":"#3B82F6"})(n,r,a),o=window.L.marker([n,r],{icon:window.L.divIcon({html:`<div class="map-marker">\n              <div class="marker-pin" style="background-color: ${s}">\n                <div class="marker-dot"></div>\n              </div>\n            </div>`,className:"custom-div-icon",iconSize:[18,24],iconAnchor:[9,24]})}),i=`\n          <div class="p-3 min-w-[200px]">\n            <h3 class="font-medium text-gray-900 mb-1">${e.name}</h3>\n            <p class="text-sm text-gray-600 mb-2">${e.location||"Location not specified"}</p>\n            <div class="space-y-2 mt-2">\n              <div class="flex items-center text-xs">\n                <span class="font-medium mr-2">Experience:</span>\n                <span>${e.total_we_months||0} months</span>\n              </div>\n              <div class="flex items-center text-xs">\n                <span class="font-medium mr-2">Status:</span>\n                <span>${(null==(t=e.computed)?void 0:t.employment_status)||"Unknown"}</span>\n              </div>\n            </div>\n            <div class="mt-3 pt-2 border-t border-gray-200">\n              <button \n                class="text-xs flex items-center text-primary-600 hover:text-primary-800 view-profile-btn"\n                data-candidate-id="${e.id}"\n              >\n                View Full Profile\n                <svg class="w-3 h-3 ml-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                  <path d="M5 12h14M12 5l7 7-7 7"/>\n                </svg>\n              </button>\n            </div>\n          </div>\n        `;return o.bindPopup(i,{className:"custom-popup",closeButton:!0,maxWidth:300}),o.on("popupopen",(()=>{const t=document.querySelector(".view-profile-btn");t&&t.addEventListener("click",(()=>{p(e),o.closePopup()}))})),o.addTo(m.current),o})),()=>{c.current&&(c.current.remove(),c.current=null),m.current&&(m.current=null)}}),[a]),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden relative",children:[h.isLoaded&&e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 bg-gradient-to-r from-indigo-50 to-white",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(r,{size:16,className:"mr-2 text-indigo-600"}),e.jsx("h3",{className:"text-base font-medium text-gray-800",children:"Candidate Locations"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-1 bg-indigo-100 px-2 py-1 rounded-full",children:[e.jsx(s,{size:14,className:"text-indigo-700"}),e.jsxs("span",{className:"text-xs font-medium text-indigo-700",children:[h.totalMapped," mapped"]})]}),e.jsx("div",{className:"flex items-center text-gray-500 text-xs",children:e.jsx("span",{children:"Click markers to view details"})})]})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{ref:l,className:"h-[500px] flex-1 relative shadow-inner",children:!h.isLoaded&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"animate-pulse flex flex-col items-center",children:[e.jsx(r,{size:30,className:"text-gray-300 mb-2"}),e.jsx("p",{className:"text-gray-400",children:"Loading map..."})]})})}),x&&e.jsxs("div",{className:"w-[500px] border-l border-gray-200 overflow-y-auto max-h-[500px] relative",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-2 flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Candidate Profile"}),e.jsx("button",{onClick:()=>p(null),className:"p-1 hover:bg-gray-100 rounded-full",children:e.jsx(o,{size:16,className:"text-gray-500"})})]}),e.jsx("div",{className:"p-4",children:e.jsx(t,{candidate:x})})]})]}),e.jsxs("div",{className:"px-4 py-3 bg-gradient-to-r from-gray-50 to-white border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(i,{size:14,className:"text-gray-400 mr-2"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Darker areas indicate higher concentration of candidates"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Low"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-lime-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Medium"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"High"})]})]})]})]})};export{a as default};
